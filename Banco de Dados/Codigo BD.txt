/* Modelo_Físico: */

CREATE TABLE Usuario (
    Nome varchar(100) not null,
    Sobrenome varchar(100) not null,
    Nome_Usuário varchar(50) not null,
    Data_de_Nascimento date not null, /*não formatada*/
    E_mail varchar(100),
    Senha varchar(50),
    IdUsuario int PRIMARY KEY auto_increment,
    Biografia text,
    Foto_Perfil blob
);

CREATE TABLE Roupa (
    IdRoupa int PRIMARY KEY auto_increment,
    Title varchar(100) not null,
    Descricao text,
    Categoria varchar(50),
    Estilo varchar(50),
    Cor varchar(50),
    Tamanho varchar(10),
    Marca varchar(30),
    Tipo varchar(100),
    Material varchar(100),
    Foto blob
);

CREATE TABLE Look (
    Roupa_de_Cima varchar(50),
    Roupa_de_Baixo varchar(50),
    IdLook int PRIMARY KEY auto_increment,
    Acessorio varchar(50)
);

CREATE TABLE Tag (
    Palavra_Chave varchar(50),
    IdTag int PRIMARY KEY auto_increment
);

CREATE TABLE Usuario_Roupa (
    fk_Usuario_IdUsuario int,
    fk_Roupa_IdRoupa int
);

CREATE TABLE Roupa_Look (
    fk_Roupa_IdRoupa int,
    fk_Look_IdLook int
);

CREATE TABLE Roupa_Tag (
    fk_Roupa_IdRoupa int,
    fk_Tag_IdTag int
);
 
ALTER TABLE Usuario_Roupa ADD CONSTRAINT FK_Usuario_Roupa_1
    FOREIGN KEY (fk_Usuario_IdUsuario)
    REFERENCES Usuario (IdUsuario)
    ON DELETE RESTRICT;
 
ALTER TABLE Usuario_Roupa ADD CONSTRAINT FK_Usuario_Roupa_2
    FOREIGN KEY (fk_Roupa_IdRoupa)
    REFERENCES Roupa (IdRoupa)
    ON DELETE SET NULL;
 
ALTER TABLE Roupa_Look ADD CONSTRAINT FK_Roupa_Look_1
    FOREIGN KEY (fk_Roupa_IdRoupa)
    REFERENCES Roupa (IdRoupa)
    ON DELETE RESTRICT;
 
ALTER TABLE Roupa_Look ADD CONSTRAINT FK_Roupa_Look_2
    FOREIGN KEY (fk_Look_IdLook)
    REFERENCES Look (IdLook)
    ON DELETE SET NULL;
 
ALTER TABLE Roupa_Tag ADD CONSTRAINT FK_Roupa_Tag_1
    FOREIGN KEY (fk_Roupa_IdRoupa)
    REFERENCES Roupa (IdRoupa)
    ON DELETE RESTRICT;
 
ALTER TABLE Roupa_Tag ADD CONSTRAINT FK_Roupa_Tag_2
    FOREIGN KEY (fk_Tag_IdTag)
    REFERENCES Tag (IdTag)
    ON DELETE RESTRICT;